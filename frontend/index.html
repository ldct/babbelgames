<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.34/browser.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.6/react-with-addons.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.6/react-dom.js"></script>
<script src="https://code.jquery.com/jquery-2.2.1.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.11.2/lodash.js"></script>

<body style="margin: 0; background-color: white">
<div id="container"></div>
</body>

<script type="text/babel">
var EpisodeTile = React.createClass({
  handleClick: function () {
    console.log(this.props.imgPrefix);
  },
  render: function () {

    var isSelected = !this.props.isPoster && this.props.srcOfMousedOverTile === this.props.src;

    var self = this;
    var tile = <div
      onMouseEnter={function () {
        self.props.onMouseEnter(self.props.src);
      }}
      style={{
        display: 'inline-block',
        width: 182,
        height: 268,
        color: 'black',
        margin: 1,
        position: 'relative',
      }}
      onClick={this.handleClick} >
      <img
        style={{
          opacity: this.props.isPoster ? 1 : (isSelected ? 0.2 : 0.7),
          position: 'absolute',
          top: 0, left: 0,
          width: '100%', height: '100%',
        }}
        src={'/img/' + this.props.src.replace('/', '.') + '.jpg'} />
      <div
        style={{
          visibility: isSelected ? 'visible' : 'hidden',
          position: 'absolute',
          top: 0, left: 0,
          width: '100%', height: '100%',
          display: 'flex',
          alignItems: 'center',
          justifyContent: 'center',
        }}>
        <div>
        {self.props.src}
        </div>
      </div>
    </div>

    if (this.props.isPoster) {
      return tile;
    } else {
      return <a href={"/matchingGameOrdered.html?src=" + this.props.src + '.srt.json'}>
        {tile}
      </a>
    }

  }
});

var App = React.createClass({
  getInitialState: function () {
    return {
      srcOfMousedOverTile: null,
    }
  },
  handleMouseOverTile: function (src) {
    this.setState({
      srcOfMousedOverTile: src,
    });
  },
  render: function () {
    var mo = this.handleMouseOverTile;
    return <div style={{
      display: 'flex',
      justifyContent: 'center',
      alignItems: 'center',
      flexWrap: 'wrap',
    }}>
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="friends.poster" isPoster={true} />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="friends/s01e01" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="friends/s01e02" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="friends/s01e03" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="silicon.valley.poster" isPoster={true} />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="silicon.valley/s01e01" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="silicon.valley/s01e02" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="silicon.valley/s01e03" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="suits.poster" isPoster={true} />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="suits/s01e01" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="suits/s01e02" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="suits/s01e03" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="parks.and.recreation.poster" isPoster={true} />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="parks.and.recreation/s01e01" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="parks.and.recreation/s01e02" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="parks.and.recreation/s01e03" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="parks.and.recreation/s01e04" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="himym.poster" isPoster={true} />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="himym/s01e01" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="himym/s01e02" />
      <EpisodeTile srcOfMousedOverTile={this.state.srcOfMousedOverTile} onMouseEnter={mo} src="himym/s01e03" />
    </div>
  }
});

ReactDOM.render(
  <App />,
  document.getElementById('container')
);

</script>
